# Energo Management Dashboard
# Home Assistant Dashboard pro AC Heating + SpotovÃ© ceny elektÅ™iny
# Instalace: NastavenÃ­ â†’ Panely â†’ PÅ™idat panel â†’ PouÅ¾Ã­t YAML reÅ¾im

title: Energo Management
views:
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # VIEW 1: PÅ˜EHLED
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  - title: PÅ™ehled
    path: prehled
    icon: mdi:home-lightning-bolt
    badges: []
    cards:
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # ROW 1: HlavnÃ­ metriky
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - type: horizontal-stack
        cards:
          # AktuÃ¡lnÃ­ spotovÃ¡ cena
          - type: tile
            entity: sensor.current_spot_electricity_price_15min
            name: SpotovÃ¡ cena
            icon: mdi:currency-eur
            color: >
              {% if states('binary_sensor.spot_electricity_is_cheapest_15min') == 'on' %}
                green
              {% elif states('sensor.current_spot_electricity_price_15min')|float > 3 %}
                red
              {% else %}
                orange
              {% endif %}

          # VenkovnÃ­ teplota
          - type: tile
            entity: sensor.ac_heating_venkovni_teplota
            name: VenkovnÃ­ teplota
            icon: mdi:thermometer
            color: >
              {% set temp = states('sensor.ac_heating_venkovni_teplota')|float %}
              {% if temp < 0 %}blue
              {% elif temp < 10 %}cyan
              {% elif temp < 20 %}green
              {% else %}orange{% endif %}

          # VÃ½kon systÃ©mu
          - type: tile
            entity: sensor.ac_heating_vykon_systemu
            name: VÃ½kon Äerpadla
            icon: mdi:lightning-bolt
            color: >
              {% set power = states('sensor.ac_heating_vykon_systemu')|float %}
              {% if power > 80 %}red
              {% elif power > 50 %}orange
              {% else %}green{% endif %}

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # ROW 2: SpotovÃ© ceny - pÅ™ehled + graf
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - type: vertical-stack
        cards:
          # Nadpis sekce
          - type: markdown
            content: |
              ## ğŸ’° SpotovÃ© ceny elektÅ™iny

          # DetailnÃ­ pÅ™ehled cen
          - type: entities
            title: AktuÃ¡lnÃ­ ceny
            show_header_toggle: false
            entities:
              - entity: sensor.current_spot_electricity_price_15min
                name: AktuÃ¡lnÃ­ cena
                icon: mdi:flash
              - entity: binary_sensor.spot_electricity_is_cheapest_15min
                name: Je teÄ nejlevnÄ›ji?
              - type: divider
              - entity: sensor.spot_cheapest_electricity_today_15min
                name: NejlevnÄ›jÅ¡Ã­ dnes
                icon: mdi:arrow-down-bold
              - entity: sensor.spot_most_expensive_electricity_today_15min
                name: NejdraÅ¾Å¡Ã­ dnes
                icon: mdi:arrow-up-bold
              - type: divider
              - entity: sensor.spot_cheapest_electricity_tomorrow_15min
                name: NejlevnÄ›jÅ¡Ã­ zÃ­tra
                icon: mdi:calendar-arrow-right
              - entity: binary_sensor.spot_electricity_has_tomorrow_data
                name: ZÃ­tÅ™ejÅ¡Ã­ data k dispozici

          # Graf spotovÃ½ch cen
          - type: custom:apexcharts-card
            header:
              show: true
              title: VÃ½voj spotovÃ½ch cen (24h)
              show_states: true
            graph_span: 24h
            span:
              start: day
            now:
              show: true
              label: NynÃ­
            series:
              - entity: sensor.current_spot_electricity_price_15min
                name: SpotovÃ¡ cena
                stroke_width: 2
                type: line
                color: '#3498db'
                show:
                  legend_value: true
                  in_header: true
            yaxis:
              - id: price
                decimals: 2
                apex_config:
                  title:
                    text: KÄ/kWh
            apex_config:
              chart:
                height: 250px
              annotations:
                yaxis:
                  - y: 3
                    borderColor: '#e74c3c'
                    label:
                      text: 'VysokÃ¡ cena'
                      style:
                        color: '#fff'
                        background: '#e74c3c'

      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      # ROW 3: AC Heating - teploty a vÃ½kon
      # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      - type: vertical-stack
        cards:
          # Nadpis sekce
          - type: markdown
            content: |
              ## ğŸ”¥ TepelnÃ© Äerpadlo AC Heating

          # Teploty
          - type: entities
            title: Teploty
            show_header_toggle: false
            entities:
              - entity: sensor.ac_heating_venkovni_teplota
                name: VenkovnÃ­
                icon: mdi:thermometer
              - entity: sensor.ac_heating_teplota_vody
                name: Teplota vody
                icon: mdi:water-thermometer
              - entity: sensor.ac_heating_pozadovana_teplota_vody
                name: PoÅ¾adovanÃ¡ voda
                icon: mdi:water-thermometer-outline
              - type: divider
              - entity: sensor.ac_heating_ktp_teplota
                name: KTP teplota
              - entity: sensor.ac_heating_akumulace_teplota
                name: Akumulace
              - entity: sensor.ac_heating_teplota_zpatecky
                name: ZpÃ¡teÄka

          # Status a vÃ½kon
          - type: entities
            title: Status a vÃ½kon
            show_header_toggle: false
            entities:
              - entity: sensor.ac_heating_vykon_systemu
                name: VÃ½kon systÃ©mu
                icon: mdi:gauge
              - entity: binary_sensor.ac_heating_bivalence_aktivni
                name: Bivalence aktivnÃ­
                icon: mdi:fire
              - entity: binary_sensor.ac_heating_bivalence_povoleno
                name: Bivalence povoleno
              - entity: sensor.ac_heating_bivalence_motohodiny
                name: Motohodiny bivalence
                icon: mdi:timer-outline

          # Graf teplot
          - type: custom:apexcharts-card
            header:
              show: true
              title: Historie teplot (24h)
              show_states: true
            graph_span: 24h
            series:
              - entity: sensor.ac_heating_venkovni_teplota
                name: VenkovnÃ­
                stroke_width: 2
                color: '#3498db'
              - entity: sensor.ac_heating_teplota_vody
                name: Voda
                stroke_width: 2
                color: '#e74c3c'
              - entity: sensor.ac_heating_akumulace_teplota
                name: Akumulace
                stroke_width: 2
                color: '#f39c12'
            yaxis:
              - id: temp
                decimals: 1
                apex_config:
                  title:
                    text: Â°C
            apex_config:
              chart:
                height: 250px

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # VIEW 2: TOPNÃ‰ OKRUHY
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  - title: TopnÃ© okruhy
    path: topne-okruhy
    icon: mdi:radiator
    badges: []
    cards:
      - type: markdown
        content: |
          ## ğŸŒ¡ï¸ TopnÃ© okruhy - ovlÃ¡dÃ¡nÃ­ termostatÅ¯

      # TopnÃ½ okruh 1-3
      - type: horizontal-stack
        cards:
          - type: thermostat
            entity: climate.ac_heating_topny_okruh_1
            name: Okruh 1

          - type: thermostat
            entity: climate.ac_heating_topny_okruh_2
            name: Okruh 2

          - type: thermostat
            entity: climate.ac_heating_topny_okruh_3
            name: Okruh 3

      # TopnÃ½ okruh 4-6
      - type: horizontal-stack
        cards:
          - type: thermostat
            entity: climate.ac_heating_topny_okruh_4
            name: Okruh 4

          - type: thermostat
            entity: climate.ac_heating_topny_okruh_5
            name: Okruh 5

          - type: thermostat
            entity: climate.ac_heating_topny_okruh_6
            name: Okruh 6

      # TopnÃ½ okruh 7-9
      - type: horizontal-stack
        cards:
          - type: thermostat
            entity: climate.ac_heating_topny_okruh_7
            name: Okruh 7

          - type: thermostat
            entity: climate.ac_heating_topny_okruh_8
            name: Okruh 8

          - type: thermostat
            entity: climate.ac_heating_topny_okruh_9
            name: Okruh 9

      # TopnÃ½ okruh 10-12
      - type: horizontal-stack
        cards:
          - type: thermostat
            entity: climate.ac_heating_topny_okruh_10
            name: Okruh 10

          - type: thermostat
            entity: climate.ac_heating_topny_okruh_11
            name: Okruh 11

          - type: thermostat
            entity: climate.ac_heating_topny_okruh_12
            name: Okruh 12

      # DetailnÃ­ pÅ™ehled vÅ¡ech okruhÅ¯
      - type: entities
        title: DetailnÃ­ pÅ™ehled topnÃ½ch okruhÅ¯
        show_header_toggle: false
        entities:
          - type: section
            label: "Okruh 1"
          - entity: climate.ac_heating_topny_okruh_1
            name: Termostat okruh 1
          - entity: binary_sensor.ac_heating_topny_okruh_1_povolen
            name: Povolen
          - entity: binary_sensor.ac_heating_topny_okruh_1_aktivni
            name: AktivnÃ­

          - type: section
            label: "Okruh 2"
          - entity: climate.ac_heating_topny_okruh_2
            name: Termostat okruh 2
          - entity: binary_sensor.ac_heating_topny_okruh_2_povolen
            name: Povolen
          - entity: binary_sensor.ac_heating_topny_okruh_2_aktivni
            name: AktivnÃ­

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # VIEW 3: TUV (TEPLÃ UÅ½ITKOVÃ VODA)
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  - title: TUV
    path: tuv
    icon: mdi:water-boiler
    badges: []
    cards:
      - type: markdown
        content: |
          ## ğŸ’§ TeplÃ¡ uÅ¾itkovÃ¡ voda (TUV)

      # TUV ovlÃ¡dÃ¡nÃ­
      - type: horizontal-stack
        cards:
          - type: custom:simple-thermostat
            entity: water_heater.ac_heating_tuv_1
            name: TUV 1
            step_size: 1

          - type: custom:simple-thermostat
            entity: water_heater.ac_heating_tuv_2
            name: TUV 2
            step_size: 1

      # TUV detaily
      - type: entities
        title: TUV 1 - detaily
        show_header_toggle: false
        entities:
          - entity: water_heater.ac_heating_tuv_1
            name: Termostat TUV 1
          - entity: binary_sensor.ac_heating_tuv_1_povolen
            name: Povolen
          - entity: binary_sensor.ac_heating_tuv_1_aktivni
            name: AktivnÃ­
          - type: divider
          - entity: binary_sensor.ac_heating_tuv_1_cirkulace_povolena
            name: Cirkulace povolena
          - entity: binary_sensor.ac_heating_tuv_1_cirkulace_aktivni
            name: Cirkulace aktivnÃ­

      - type: entities
        title: TUV 2 - detaily
        show_header_toggle: false
        entities:
          - entity: water_heater.ac_heating_tuv_2
            name: Termostat TUV 2
          - entity: binary_sensor.ac_heating_tuv_2_povolen
            name: Povolen
          - entity: binary_sensor.ac_heating_tuv_2_aktivni
            name: AktivnÃ­
          - type: divider
          - entity: binary_sensor.ac_heating_tuv_2_cirkulace_povolena
            name: Cirkulace povolena
          - entity: binary_sensor.ac_heating_tuv_2_cirkulace_aktivni
            name: Cirkulace aktivnÃ­

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # VIEW 4: AUTOMATIZACE
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  - title: Automatizace
    path: automatizace
    icon: mdi:robot
    badges: []
    cards:
      - type: markdown
        content: |
          ## ğŸ¤– Energo management automatizace

          ChytrÃ© automatizace pro optimalizaci spotÅ™eby podle spotovÃ½ch cen.

      # Kdy topenÃ­?
      - type: entities
        title: OptimÃ¡lnÃ­ Äasy pro spotÅ™ebu
        show_header_toggle: false
        entities:
          - entity: binary_sensor.spot_electricity_is_cheapest_15min
            name: TeÄ je nejlevnÄ›ji
            icon: mdi:clock-star
          - entity: sensor.current_spot_electricity_price_15min
            name: AktuÃ¡lnÃ­ cena
          - entity: sensor.spot_cheapest_electricity_today_15min
            name: NejlevnÄ›jÅ¡Ã­ dnes
          - entity: sensor.current_spot_electricity_15min_order
            name: PoÅ™adÃ­ aktuÃ¡lnÃ­ ceny (dnes)

      # PÅ™Ã­klady automatizacÃ­
      - type: markdown
        content: |
          ### ğŸ’¡ PÅ™Ã­klady automatizacÃ­

          #### 1. NabÃ­jenÃ­ TUV pÅ™i levnÃ© elektÅ™inÄ›
          ```yaml
          automation:
            - alias: "TUV nabÃ­jenÃ­ pÅ™i levnÃ© cenÄ›"
              trigger:
                - platform: state
                  entity_id: binary_sensor.spot_electricity_is_cheapest_15min
                  to: "on"
              condition:
                - condition: numeric_state
                  entity_id: sensor.current_spot_electricity_price_15min
                  below: 2
              action:
                - service: water_heater.set_temperature
                  target:
                    entity_id: water_heater.ac_heating_tuv_1
                  data:
                    temperature: 55
          ```

          #### 2. SnÃ­Å¾enÃ­ teploty pÅ™i drahÃ© elektÅ™inÄ›
          ```yaml
          automation:
            - alias: "SnÃ­Å¾enÃ­ teploty pÅ™i vysokÃ© cenÄ›"
              trigger:
                - platform: numeric_state
                  entity_id: sensor.current_spot_electricity_price_15min
                  above: 4
              action:
                - service: climate.set_temperature
                  target:
                    entity_id:
                      - climate.ac_heating_topny_okruh_1
                      - climate.ac_heating_topny_okruh_2
                  data:
                    temperature: 20
          ```

          #### 3. ZapnutÃ­ bivalence pÅ™i extrÃ©mnÃ­ cenÄ›
          ```yaml
          automation:
            - alias: "Bivalence pÅ™i extrÃ©mnÃ­ cenÄ›"
              trigger:
                - platform: numeric_state
                  entity_id: sensor.current_spot_electricity_price_15min
                  above: 5
              condition:
                - condition: numeric_state
                  entity_id: sensor.ac_heating_venkovni_teplota
                  below: 0
              action:
                - service: switch.turn_on
                  target:
                    entity_id: binary_sensor.ac_heating_bivalence_povoleno
          ```

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # VIEW 5: DIAGNOSTIKA
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  - title: Diagnostika
    path: diagnostika
    icon: mdi:chart-line
    badges: []
    cards:
      - type: markdown
        content: |
          ## ğŸ“Š Diagnostika a monitoring

      # Statistiky systÃ©mu
      - type: entities
        title: SystÃ©m - zÃ¡kladnÃ­ Ãºdaje
        show_header_toggle: false
        entities:
          - entity: sensor.ac_heating_venkovni_teplota
            name: VenkovnÃ­ teplota
          - entity: sensor.ac_heating_vykon_systemu
            name: VÃ½kon systÃ©mu
          - entity: binary_sensor.ac_heating_hlavni_vypinac
            name: HlavnÃ­ vypÃ­naÄ
          - type: divider
          - entity: binary_sensor.ac_heating_kriticky_alarm
            name: KritickÃ½ alarm
          - entity: binary_sensor.ac_heating_alarm
            name: Alarm
          - entity: binary_sensor.ac_heating_info
            name: Info

      # VÅ¡echny teploty
      - type: entities
        title: VÅ¡echny teploty systÃ©mu
        show_header_toggle: false
        entities:
          - type: section
            label: "ZÃ¡kladnÃ­"
          - entity: sensor.ac_heating_venkovni_teplota
            name: VenkovnÃ­
          - entity: sensor.ac_heating_venkovni_teplota_nefiltrovana
            name: VenkovnÃ­ (nefiltrovanÃ¡)
          - entity: sensor.ac_heating_teplota_vody
            name: Voda
          - entity: sensor.ac_heating_pozadovana_teplota_vody
            name: Voda poÅ¾adovanÃ¡

          - type: section
            label: "Akumulace a KTP"
          - entity: sensor.ac_heating_ktp_teplota
            name: KTP
          - entity: sensor.ac_heating_akumulace_teplota
            name: Akumulace
          - entity: sensor.ac_heating_teplota_zpatecky
            name: ZpÃ¡teÄka
          - entity: sensor.ac_heating_teplota_zpatecky_tuv
            name: ZpÃ¡teÄka TUV

      # DlouhodobÃ© grafy
      - type: custom:apexcharts-card
        header:
          show: true
          title: DlouhodobÃ½ vÃ½voj (7 dnÃ­)
          show_states: true
        graph_span: 7d
        series:
          - entity: sensor.ac_heating_venkovni_teplota
            name: VenkovnÃ­ teplota
            stroke_width: 1
            color: '#3498db'
            show:
              legend_value: false
          - entity: sensor.current_spot_electricity_price_15min
            name: SpotovÃ¡ cena
            stroke_width: 1
            color: '#e74c3c'
            yaxis_id: price
        yaxis:
          - id: temp
            decimals: 1
            apex_config:
              title:
                text: Â°C
          - id: price
            opposite: true
            decimals: 2
            apex_config:
              title:
                text: KÄ/kWh
        apex_config:
          chart:
            height: 300px
